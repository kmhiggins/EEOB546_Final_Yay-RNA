---
title: "Figures 1 & 2 Workflow"
output: html_document
---

### Figure 1
\ 

- took sRNA and mRNA counts from Kaitlin and converted the .txt files
- also created data.frame files that contain the column names for each data set and then also the row names (used column 1 because the actual row is just numbers)
```{r echo=TRUE, results='hide'}
s <- read.delim("OriginalData/sRNA_raw_counts.txt")
m <- read.delim("OriginalData/mRNA_raw_counts.txt")
colname_m <- as.data.frame(colnames(m))
colname_s <- as.data.frame(colnames(s))
rowname_m <- as.data.frame(m[,"Geneid"])
rowname_s <- as.data.frame(s[,"Geneid"])
```
\ 

- Kaitlin did run into an issue with generating all the SRA files for the sRNA which explains why there is only 57 samples in the sRNA set 
- Next I am going to create a file that pushes the column "Geneid" into the row names 

```{r echo=TRUE, results='hide'}
m_row <- m
rownames(m_row) <- m_row$Geneid
m_row <- subset(m_row, select = -Geneid)

s_row <- s
rownames(s_row) <- s_row$Geneid
s_row <- subset(s_row, select = -Geneid)
```
\ 

- Now we are going to start creating the data format we want to create Figure 1A
  - To do this, we need to remove all genes that contain no sRNA mapping in every sample

```{r echo=TRUE, results='hide'}
s_mapping1 <- s_row[rowSums(s_row[])>0,]
```
\ 

- next create data frames that are specific to each tissue type
```{r echo=TRUE, message=FALSE, warning=FALSE, results='hide'}
library(dplyr)
```

```{r echo=TRUE, results='hide'}
s_mapgeneR <- s_mapping1 %>% select(ends_with('R.sam'))
s_mapgeneE <- s_mapping1 %>% select(ends_with('E.sam'))
s_mapgeneS <- s_mapping1 %>% select(ends_with('S.sam'))
s_mapgeneI <- s_mapping1 %>% select(ends_with('I.sam'))
s_mapgeneL <- s_mapping1 %>% select(ends_with('L.sam'))
```
\ 

- once again, go through and use rowsums to remove genes that contain no sRNA mapping

```{r echo=TRUE, results='hide'}
s_mapgeneR <- s_mapgeneR[rowSums(s_mapgeneR[])>0,]
s_mapgeneE <- s_mapgeneE[rowSums(s_mapgeneE[])>0,]
s_mapgeneS <- s_mapgeneS[rowSums(s_mapgeneS[])>0,]
s_mapgeneI <- s_mapgeneI[rowSums(s_mapgeneI[])>0,]
s_mapgeneL <- s_mapgeneL[rowSums(s_mapgeneL[])>0,]
```
\ 

- do another row sum to find out the mapping of each sRNA amongst all samples

```{r echo=TRUE, results='hide'}
s_Rsum <- as.data.frame(rowSums(s_mapgeneR))
s_Esum <- as.data.frame(rowSums(s_mapgeneE))
s_Ssum <- as.data.frame(rowSums(s_mapgeneS))
s_Isum <- as.data.frame(rowSums(s_mapgeneI))
s_Lsum <- as.data.frame(rowSums(s_mapgeneL))
```
\ 

- taking a quick look at the data, it is easy to see that the graph generated from this will not resemble the original figures at all
- this could be due to the issues Kaitlin ran into when trying to extract all SRA files and we now only have half of the samples to work with 
- anyways, next we need to generate percentages for the mapping frequency values that the paper used which is 1 (unique), 2 to 10, 11 to 50 and >50 
  - first going to count up the frequency of each occurence

```{r echo=TRUE}
s_freqR <- count(s_Rsum)
colSums(s_freqR)
s_finalR <- data.frame(c("Mapping", "Percentage"), c("1", "0.854"), c("2 to 10", ".113"), c("11 to 50", "0.024"), c(">50", "0.009"))

s_freqE <- count(s_Esum)
colSums(s_freqE)
s_finalE <- data.frame(c("Mapping", "Percentage"), c("1", "0.859"), c("2 to 10", "0.114"), c("11 to 50", "0.02"), c(">50", "0.007"))

